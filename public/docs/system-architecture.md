# ğŸ—ï¸ Bluecore Platform - Kiáº¿n trÃºc Há»‡ thá»‘ng & Spec Chi tiáº¿t

> **PhiÃªn báº£n:** 3.0  
> **Cáº­p nháº­t:** 2025-01-14

---

## ğŸ“‘ Má»¥c lá»¥c

1. [Tá»•ng quan Kiáº¿n trÃºc](#1-tá»•ng-quan-kiáº¿n-trÃºc)
2. [SÆ¡ Ä‘á»“ Há»‡ thá»‘ng Chi tiáº¿t](#2-sÆ¡-Ä‘á»“-há»‡-thá»‘ng-chi-tiáº¿t)
3. [Module FDP - Financial Data Platform](#3-module-fdp---financial-data-platform)
4. [Module Control Tower](#4-module-control-tower)
5. [Module MDP - Marketing Data Platform](#5-module-mdp---marketing-data-platform)
6. [Module Scenario & Planning](#6-module-scenario--planning)
7. [Module Decision Support](#7-module-decision-support)
8. [Data Warehouse & Integration](#8-data-warehouse--integration)
9. [Luá»“ng dá»¯ liá»‡u End-to-End](#9-luá»“ng-dá»¯-liá»‡u-end-to-end)
10. [Database Schema Overview](#10-database-schema-overview)

---

## 1. Tá»•ng quan Kiáº¿n trÃºc

### 1.1 Triáº¿t lÃ½ Thiáº¿t káº¿

Bluecore Platform Ä‘Æ°á»£c xÃ¢y dá»±ng dá»±a trÃªn cÃ¡c nguyÃªn táº¯c cá»‘t lÃµi:

| NguyÃªn táº¯c | MÃ´ táº£ |
|------------|-------|
| **Single Source of Truth** | 1 Net Revenue, 1 Contribution Margin, 1 Cash Position - khÃ´ng cÃ³ phiÃªn báº£n khÃ¡c |
| **Real Cash** | PhÃ¢n biá»‡t rÃµ: Cash Ä‘Ã£ vá» / sáº½ vá» / cÃ³ nguy cÆ¡ khÃ´ng vá» / Ä‘ang bá»‹ khÃ³a |
| **Truth > Flexibility** | KhÃ´ng cho tÃ¹y chá»‰nh cÃ´ng thá»©c Ä‘á»ƒ trÃ¡nh "chá»n sá»‘ Ä‘áº¹p" |
| **Revenue â†” Cost** | Má»i doanh thu Ä‘á»u Ä‘i kÃ¨m chi phÃ­ tÆ°Æ¡ng á»©ng |
| **Today's Decision** | Phá»¥c vá»¥ quyáº¿t Ä‘á»‹nh hÃ´m nay, khÃ´ng pháº£i bÃ¡o cÃ¡o cuá»‘i thÃ¡ng |

### 1.2 Stack CÃ´ng nghá»‡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FRONTEND                                    â”‚
â”‚  React 18 + TypeScript + Vite + TailwindCSS + Framer Motion        â”‚
â”‚  Capacitor (Mobile: iOS/Android)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         BACKEND (Lovable Cloud)                     â”‚
â”‚  Supabase: PostgreSQL + Auth + Realtime + Edge Functions + Storage â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DATA SOURCES                                â”‚
â”‚  BigQuery â”‚ E-commerce APIs â”‚ Banking APIs â”‚ POS â”‚ ERP             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. SÆ¡ Ä‘á»“ Há»‡ thá»‘ng Chi tiáº¿t

### 2.1 High-Level Architecture

```
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚              BLUECORE PLATFORM                 â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                    â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                  â”‚                       â”‚                       â”‚                  â”‚
         â–¼                  â–¼                       â–¼                       â–¼                  â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚    FDP    â”‚      â”‚  Control  â”‚          â”‚    MDP    â”‚          â”‚ Scenario  â”‚      â”‚ Decision  â”‚
   â”‚ Financial â”‚      â”‚   Tower   â”‚          â”‚ Marketing â”‚          â”‚ Planning  â”‚      â”‚  Support  â”‚
   â”‚  Platform â”‚      â”‚           â”‚          â”‚  Platform â”‚          â”‚           â”‚      â”‚           â”‚
   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚                  â”‚                       â”‚                       â”‚                  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                    â”‚
                                                    â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚              DATA WAREHOUSE HUB               â”‚
                              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
                              â”‚  â”‚ BigQueryâ”‚ â”‚Connectorsâ”‚ â”‚  ETL   â”‚          â”‚
                              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                    â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                 â”‚                   â”‚                   â”‚                 â”‚
              â–¼                 â–¼                   â–¼                   â–¼                 â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Shopee  â”‚      â”‚  Lazada  â”‚        â”‚  TikTok  â”‚        â”‚   POS    â”‚      â”‚  Banking â”‚
        â”‚   API    â”‚      â”‚   API    â”‚        â”‚   Shop   â”‚        â”‚  Systems â”‚      â”‚   APIs   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 Data Flow Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    DATA SOURCES                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚   E-COMMERCE              SHIPPING             BANKING              ERP/POS             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚   â”‚ Shopee  â”‚            â”‚   GHN   â”‚          â”‚   VCB   â”‚          â”‚  KiotVietâ”‚          â”‚
â”‚   â”‚ Lazada  â”‚            â”‚  GHTK   â”‚          â”‚   TCB   â”‚          â”‚  Sapo   â”‚          â”‚
â”‚   â”‚ TikTok  â”‚            â”‚ Viettel â”‚          â”‚   MBB   â”‚          â”‚  MISA   â”‚          â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜          â”‚
â”‚        â”‚                      â”‚                    â”‚                    â”‚               â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                         â”‚                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              SYNC CONNECTORS LAYER                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚   â”‚  sync-connector  â”‚  â”‚  sync-bigquery   â”‚  â”‚ sync-ecommerce   â”‚                       â”‚
â”‚   â”‚  (Edge Function) â”‚  â”‚  (Edge Function) â”‚  â”‚  (Edge Function) â”‚                       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚            â”‚                     â”‚                     â”‚                                 â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚                                  â”‚                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              SUPABASE DATABASE                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚   CORE TABLES              ANALYTICS TABLES          ALERT TABLES                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚   â”‚external_ordersâ”‚        â”‚channel_analytics â”‚       â”‚alert_instances  â”‚                 â”‚
â”‚   â”‚invoices     â”‚          â”‚marketing_expensesâ”‚       â”‚intelligent_rulesâ”‚                 â”‚
â”‚   â”‚bills        â”‚          â”‚promotion_campaignsâ”‚      â”‚alert_objects    â”‚                 â”‚
â”‚   â”‚bank_accountsâ”‚          â”‚channel_settlementsâ”‚      â”‚escalation_rules â”‚                 â”‚
â”‚   â”‚products     â”‚          â”‚channel_pl_cache  â”‚       â”‚notification_logsâ”‚                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚          â”‚                          â”‚                         â”‚                          â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                                     â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              PROCESSING LAYER                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚   â”‚  detect-alerts   â”‚  â”‚analyze-financial â”‚  â”‚ optimize-budget  â”‚                       â”‚
â”‚   â”‚  (Edge Function) â”‚  â”‚  (Edge Function) â”‚  â”‚  (Edge Function) â”‚                       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚            â”‚                     â”‚                     â”‚                                 â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚                                  â”‚                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              APPLICATION MODULES                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚    FDP    â”‚   â”‚  Control  â”‚   â”‚    MDP    â”‚   â”‚ Scenario  â”‚   â”‚ Decision  â”‚         â”‚
â”‚   â”‚           â”‚   â”‚   Tower   â”‚   â”‚           â”‚   â”‚ Planning  â”‚   â”‚  Support  â”‚         â”‚
â”‚   â”‚ Dashboard â”‚   â”‚  Alerts   â”‚   â”‚ Marketing â”‚   â”‚ What-If   â”‚   â”‚ Analysis  â”‚         â”‚
â”‚   â”‚ Cash Flow â”‚   â”‚   Tasks   â”‚   â”‚  CMO/Mkt  â”‚   â”‚  Budget   â”‚   â”‚    AI     â”‚         â”‚
â”‚   â”‚ Unit Econ â”‚   â”‚  Escalate â”‚   â”‚  Profit   â”‚   â”‚ Forecast  â”‚   â”‚  Advisor  â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. Module FDP - Financial Data Platform

### 3.1 Má»¥c Ä‘Ã­ch
FDP lÃ  ná»n táº£ng tÃ i chÃ­nh cá»‘t lÃµi, cung cáº¥p **Financial Truth** cho CEO/CFO Ä‘á»ƒ ra quyáº¿t Ä‘á»‹nh Ä‘iá»u hÃ nh. **KHÃ”NG PHáº¢I** pháº§n má»m káº¿ toÃ¡n.

### 3.2 MÃ n hÃ¬nh chÃ­nh

| MÃ n hÃ¬nh | Route | MÃ´ táº£ |
|----------|-------|-------|
| CFO Dashboard | `/` | Tá»•ng quan tÃ i chÃ­nh: Cash, AR, AP, DSO, DPO, CCC |
| Cash Flow Direct | `/cash-flow` | DÃ²ng tiá»n thá»±c táº¿ theo phÆ°Æ¡ng phÃ¡p trá»±c tiáº¿p |
| Cash Forecast | `/cash-forecast` | Dá»± bÃ¡o dÃ²ng tiá»n 30 ngÃ y, 13 tuáº§n |
| Unit Economics | `/unit-economics` | PhÃ¢n tÃ­ch hiá»‡u quáº£ theo SKU/kÃªnh |
| Channel P&L | `/channel-pl` | LÃ£i lá»— theo tá»«ng kÃªnh bÃ¡n hÃ ng |
| Working Capital | `/working-capital` | Quáº£n lÃ½ vá»‘n lÆ°u Ä‘á»™ng |
| AR Operations | `/ar-operations` | Quáº£n lÃ½ cÃ´ng ná»£ pháº£i thu |
| Bills (AP) | `/bills` | Quáº£n lÃ½ cÃ´ng ná»£ pháº£i tráº£ |

### 3.3 Báº£ng dá»¯ liá»‡u chÃ­nh

| Báº£ng | Má»¥c Ä‘Ã­ch | TrÆ°á»ng quan trá»ng |
|------|----------|-------------------|
| `bank_accounts` | TÃ i khoáº£n ngÃ¢n hÃ ng | `current_balance`, `status` |
| `bank_transactions` | Giao dá»‹ch ngÃ¢n hÃ ng | `amount`, `transaction_type`, `transaction_date` |
| `invoices` | HÃ³a Ä‘Æ¡n bÃ¡n hÃ ng (AR) | `total_amount`, `paid_amount`, `due_date`, `status` |
| `bills` | HÃ³a Ä‘Æ¡n mua hÃ ng (AP) | `total_amount`, `paid_amount`, `due_date`, `status` |
| `expenses` | Chi phÃ­ hoáº¡t Ä‘á»™ng | `amount`, `category`, `expense_date` |
| `external_orders` | ÄÆ¡n hÃ ng e-commerce | `order_value`, `channel`, `order_status` |
| `external_products` | Sáº£n pháº©m | `cost_price`, `selling_price`, `stock_quantity` |
| `channel_settlements` | Thanh toÃ¡n tá»« sÃ n | `gross_sales`, `total_fees`, `net_amount` |

### 3.4 KPI & CÃ´ng thá»©c

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     FDP CORE FORMULAS                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  NET REVENUE = Gross Sales - Returns - Discounts - Platform Feesâ”‚
â”‚                                                                  â”‚
â”‚  CONTRIBUTION MARGIN = Net Revenue - COGS - Variable Costs      â”‚
â”‚                                                                  â”‚
â”‚  REAL CASH POSITION = Bank Balance                              â”‚
â”‚                       + AR sáº½ vá» (trá»ng sá»‘ theo tuá»•i ná»£)        â”‚
â”‚                       - AP pháº£i tráº£ (trong ká»³)                  â”‚
â”‚                       - Cash bá»‹ khÃ³a (inventory, ads, deposits) â”‚
â”‚                                                                  â”‚
â”‚  DSO = (Total AR Ã— 90) / Revenue 90 ngÃ y                        â”‚
â”‚  DPO = (Total AP Ã— 90) / COGS 90 ngÃ y                           â”‚
â”‚  DIO = (Inventory Value Ã— 90) / COGS 90 ngÃ y                    â”‚
â”‚  CCC = DSO + DIO - DPO                                          â”‚
â”‚                                                                  â”‚
â”‚  CASH RUNWAY = Current Cash / Monthly Burn Rate                 â”‚
â”‚                                                                  â”‚
â”‚  GROSS MARGIN = (Revenue - COGS) / Revenue Ã— 100%               â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.5 Rule Logic

| Rule | Äiá»u kiá»‡n | HÃ nh Ä‘á»™ng |
|------|-----------|-----------|
| AR Overdue Alert | `days_overdue > 30` AND `amount > threshold` | Táº¡o alert, thÃ´ng bÃ¡o collector |
| Cash Runway Warning | `runway_months < 3` | Escalate to CFO/CEO |
| SKU Stop Signal | `contribution_margin < 0` AND `cash_locked > threshold` | Äá» xuáº¥t ngá»«ng bÃ¡n SKU |
| AP Priority | `due_date - today <= 7` AND `discount_available` | Äá» xuáº¥t thanh toÃ¡n sá»›m |

---

## 4. Module Control Tower

### 4.1 Má»¥c Ä‘Ã­ch
Control Tower lÃ  **Alert & Decision Engine**, KHÃ”NG PHáº¢I dashboard. Tá»“n táº¡i Ä‘á»ƒ bÃ¡o Ä‘á»™ng vÃ  Ã©p hÃ nh Ä‘á»™ng.

### 4.2 MÃ n hÃ¬nh chÃ­nh

| MÃ n hÃ¬nh | Route | MÃ´ táº£ |
|----------|-------|-------|
| Alerts | `/control-tower/alerts` | Danh sÃ¡ch cáº£nh bÃ¡o Ä‘ang active |
| Tasks | `/control-tower/tasks` | Quáº£n lÃ½ task tá»« alert |
| Intelligent Rules | `/control-tower/rules` | Cáº¥u hÃ¬nh rule phÃ¡t hiá»‡n |
| Analytics | `/control-tower/analytics` | Thá»‘ng kÃª alert & resolution |
| Team | `/control-tower/team` | Quáº£n lÃ½ ngÆ°á»i nháº­n thÃ´ng bÃ¡o |
| Settings | `/control-tower/settings` | Cáº¥u hÃ¬nh escalation |

### 4.3 Báº£ng dá»¯ liá»‡u chÃ­nh

| Báº£ng | Má»¥c Ä‘Ã­ch | TrÆ°á»ng quan trá»ng |
|------|----------|-------------------|
| `intelligent_alert_rules` | Äá»‹nh nghÄ©a rule | `rule_name`, `calculation_formula`, `threshold_config`, `severity` |
| `alert_instances` | Alert Ä‘Ã£ phÃ¡t hiá»‡n | `title`, `severity`, `impact_amount`, `assigned_to`, `status` |
| `alert_objects` | Äá»‘i tÆ°á»£ng giÃ¡m sÃ¡t | `object_type`, `object_name`, `current_metrics` |
| `alert_escalation_rules` | Quy táº¯c leo thang | `escalate_after_minutes`, `escalate_to_role` |
| `alert_notification_logs` | Log thÃ´ng bÃ¡o | `channel`, `recipient`, `status`, `sent_at` |
| `notification_recipients` | NgÆ°á»i nháº­n | `name`, `email`, `phone`, `role` |

### 4.4 Alert Structure (Báº¯t buá»™c)

```typescript
interface ValidAlert {
  // Má»—i alert PHáº¢I tráº£ lá»i Ä‘á»§ 3 cÃ¢u há»i:
  impact_amount: number;        // Máº¥t bao nhiÃªu tiá»n?
  impact_if_unresolved: number; // KhÃ´ng xá»­ lÃ½ sáº½ máº¥t thÃªm bao nhiÃªu?
  deadline_at: Date;            // CÃ²n bao lÃ¢u Ä‘á»ƒ hÃ nh Ä‘á»™ng?
  
  // Metadata
  title: string;
  severity: 'critical' | 'warning' | 'info';
  category: string;
  
  // Ownership
  assigned_to: string;          // Alert PHáº¢I cÃ³ owner
  status: 'open' | 'in_progress' | 'resolved';
  resolution_notes?: string;    // Outcome sau xá»­ lÃ½
}
```

### 4.5 Rule Logic & Formulas

| Rule Category | Example Rules | Formula |
|---------------|---------------|---------|
| **Cash & Liquidity** | Cash Runway Low | `cash_runway_months < 3` |
| | Cash Balance Drop | `(cash_today - cash_yesterday) / cash_yesterday < -0.1` |
| **Revenue & Orders** | Revenue Decline | `revenue_today / revenue_avg_7d < 0.8` |
| | Order Cancellation High | `cancelled_orders / total_orders > 0.05` |
| **Marketing** | ROAS Below Threshold | `revenue / ad_spend < 2` |
| | CAC Increase | `cac_today / cac_avg_30d > 1.2` |
| **Inventory** | Stockout Risk | `stock_quantity / avg_daily_sales < lead_time_days` |
| | Overstock Alert | `days_of_inventory > 90` |
| **AR/AP** | AR Aging Critical | `ar_over_90_days / total_ar > 0.2` |
| | Bill Due Approaching | `bill_due_in_days <= 3` |

### 4.6 Escalation Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     15 min      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     30 min      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Owner   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚ Manager  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚   CFO    â”‚
â”‚ Assigned â”‚    No Action    â”‚ Notified â”‚    No Action    â”‚ Notified â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                â”‚
                                                                â”‚ 60 min
                                                                â”‚ No Action
                                                                â–¼
                                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                          â”‚   CEO    â”‚
                                                          â”‚ Notified â”‚
                                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. Module MDP - Marketing Data Platform

### 5.1 Má»¥c Ä‘Ã­ch
MDP Ä‘o lÆ°á»ng **GIÃ TRá»Š TÃ€I CHÃNH THáº¬T** cá»§a marketing. KHÃ”NG PHáº¢I MarTech Ä‘á»ƒ cháº¡y quáº£ng cÃ¡o.

### 5.2 Two Modes

| Mode | NgÆ°á»i dÃ¹ng | Má»¥c Ä‘Ã­ch |
|------|------------|----------|
| **CMO Mode** | CEO, CFO, CMO | Ra quyáº¿t Ä‘á»‹nh: Scale/Stop/Optimize dá»±a trÃªn profit & cash |
| **Marketing Mode** | Marketing Team | Execution: Campaign performance, funnel, A/B testing |

### 5.3 MÃ n hÃ¬nh chÃ­nh

**CMO Mode:**
| MÃ n hÃ¬nh | Route | MÃ´ táº£ |
|----------|-------|-------|
| Command Center | `/mdp/cmo-mode` | Overview + Quick Actions |
| Profit Attribution | `/mdp/profit` | Profit tháº­t tá»« marketing |
| Cash Impact | `/mdp/cash-impact` | Marketing áº£nh hÆ°á»Ÿng cash tháº¿ nÃ o |
| Risk Alerts | `/mdp/risks` | Marketing risks |
| Decisions | `/mdp/decisions` | Scale/Stop recommendations |

**Marketing Mode:**
| MÃ n hÃ¬nh | Route | MÃ´ táº£ |
|----------|-------|-------|
| Overview | `/mdp/marketing-mode` | Performance metrics |
| Campaigns | `/mdp/campaigns` | Chi tiáº¿t campaigns |
| Channels | `/mdp/channels` | Performance theo platform |
| Funnel | `/mdp/funnel` | Conversion funnel |
| ROI Analytics | `/mdp/roi-analytics` | ROAS & ROI analysis |
| A/B Testing | `/mdp/ab-testing` | Káº¿t quáº£ thá»­ nghiá»‡m |

### 5.4 Báº£ng dá»¯ liá»‡u chÃ­nh

| Báº£ng | Má»¥c Ä‘Ã­ch | TrÆ°á»ng quan trá»ng |
|------|----------|-------------------|
| `promotion_campaigns` | Campaigns | `name`, `channel`, `budget`, `actual_cost`, `start/end_date` |
| `marketing_expenses` | Chi phÃ­ MKT | `expense_type`, `channel`, `amount`, `expense_date` |
| `channel_analytics` | Metrics tá»« ads | `impressions`, `clicks`, `spend`, `conversions`, `revenue` |
| `channel_fees` | PhÃ­ platform | `fee_type`, `fee_amount`, `channel` |
| `channel_pl_cache` | P&L Ä‘Ã£ tÃ­nh | `channel`, `revenue`, `cogs`, `fees`, `profit`, `margin` |

### 5.5 KPI & CÃ´ng thá»©c

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     MDP CORE FORMULAS                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  ROAS (Traditional) = Revenue / Ad Spend                        â”‚
â”‚                                                                  â”‚
â”‚  PROFIT ROAS = Contribution Margin / Ad Spend                   â”‚
â”‚             = (Revenue - COGS - Fees - Shipping) / Ad Spend     â”‚
â”‚                                                                  â”‚
â”‚  TRUE CAC = (Ad Spend + MKT Salaries + Tools) / New Customers   â”‚
â”‚                                                                  â”‚
â”‚  LTV:CAC = Customer Lifetime Value / CAC                        â”‚
â”‚         â‰¥ 3 is healthy, < 1 is losing money                     â”‚
â”‚                                                                  â”‚
â”‚  DAYS TO CASH = AVG(order_date â†’ payment_received_date)         â”‚
â”‚                                                                  â”‚
â”‚  MARKETING ROI = (Revenue - Cost - Ad Spend) / Ad Spend Ã— 100%  â”‚
â”‚                                                                  â”‚
â”‚  CASH LOCKED IN ADS = Ad Spend + Days_to_Cash Ã— Daily_Ad_Spend  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.6 Decision Logic

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        MARKETING DECISION TREE                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚                         â”‚ Profit ROAS > 1 â”‚                                 â”‚
â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚                                  â”‚                                          â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚              â”‚ YES                                   â”‚ NO                   â”‚
â”‚              â–¼                                       â–¼                      â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚     â”‚ LTV:CAC â‰¥ 3?   â”‚                      â”‚   STOP/REDUCE  â”‚              â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚   Immediately  â”‚              â”‚
â”‚             â”‚                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”                                                       â”‚
â”‚     â”‚ YES       â”‚ NO                                                        â”‚
â”‚     â–¼           â–¼                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                    â”‚
â”‚  â”‚SCALE â”‚  â”‚ MAINTAIN  â”‚                                                    â”‚
â”‚  â”‚Budgetâ”‚  â”‚ Optimize  â”‚                                                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                    â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. Module Scenario & Planning

### 6.1 MÃ n hÃ¬nh chÃ­nh

| MÃ n hÃ¬nh | Route | MÃ´ táº£ |
|----------|-------|-------|
| Scenario Hub | `/scenario` | Quáº£n lÃ½ cÃ¡c scenario |
| What-If Analysis | `/what-if` | MÃ´ phá»ng ká»‹ch báº£n |
| Budget vs Actual | `/budget` | So sÃ¡nh thá»±c táº¿ vá»›i ngÃ¢n sÃ¡ch |
| Rolling Forecast | `/rolling-forecast` | Dá»± bÃ¡o cuá»‘n chiáº¿u |

### 6.2 Báº£ng dá»¯ liá»‡u chÃ­nh

| Báº£ng | Má»¥c Ä‘Ã­ch |
|------|----------|
| `scenarios` | Äá»‹nh nghÄ©a ká»‹ch báº£n |
| `scenario_assumptions` | Giáº£ Ä‘á»‹nh Ä‘áº§u vÃ o |
| `monthly_plans` | Káº¿ hoáº¡ch theo thÃ¡ng |
| `budget_items` | Chi tiáº¿t ngÃ¢n sÃ¡ch |
| `forecast_inputs` | Äáº§u vÃ o dá»± bÃ¡o |
| `cash_forecasts` | Káº¿t quáº£ dá»± bÃ¡o dÃ²ng tiá»n |

### 6.3 What-If Parameters

```typescript
interface WhatIfParams {
  // Revenue
  revenue_change_percent: number;      // -50% to +100%
  new_channel_revenue: number;
  price_change_percent: number;
  
  // Costs
  cogs_change_percent: number;
  opex_change_percent: number;
  marketing_spend_change: number;
  
  // Working Capital
  dso_change_days: number;
  dpo_change_days: number;
  dio_change_days: number;
  
  // Events
  large_customer_loss: boolean;
  new_market_entry: boolean;
  supplier_change: boolean;
}
```

---

## 7. Module Decision Support

### 7.1 MÃ n hÃ¬nh chÃ­nh

| MÃ n hÃ¬nh | Route | MÃ´ táº£ |
|----------|-------|-------|
| Decision Center | `/decision-center` | Dashboard quyáº¿t Ä‘á»‹nh |
| ROI Analysis | `/decision-support` | PhÃ¢n tÃ­ch ROI dá»± Ã¡n |

### 7.2 Decision Card Structure

```typescript
interface DecisionCard {
  id: string;
  type: 'scale' | 'stop' | 'optimize' | 'invest' | 'divest';
  
  context: {
    entity_type: 'sku' | 'campaign' | 'channel' | 'product_line';
    entity_id: string;
    entity_name: string;
  };
  
  financial_impact: {
    current_profit: number;
    projected_profit: number;
    cash_impact: number;
    roi_percent: number;
    payback_months: number;
  };
  
  recommendation: {
    action: string;
    urgency: 'immediate' | 'this_week' | 'this_month';
    confidence: number;        // 0-100%
    supporting_data: any[];
  };
  
  decision: {
    status: 'pending' | 'approved' | 'rejected' | 'deferred';
    decided_by: string;
    decided_at: Date;
    notes: string;
  };
}
```

### 7.3 Báº£ng dá»¯ liá»‡u

| Báº£ng | Má»¥c Ä‘Ã­ch |
|------|----------|
| `decision_analyses` | PhÃ¢n tÃ­ch Ä‘áº§u tÆ° |
| `auto_decision_card_states` | Tráº¡ng thÃ¡i decision cards |
| `capex_projects` | Dá»± Ã¡n Ä‘áº§u tÆ° vá»‘n |
| `strategic_initiatives` | SÃ¡ng kiáº¿n chiáº¿n lÆ°á»£c |

---

## 8. Data Warehouse & Integration

### 8.1 MÃ n hÃ¬nh chÃ­nh

| MÃ n hÃ¬nh | Route | MÃ´ táº£ |
|----------|-------|-------|
| Data Hub | `/data-hub` | Tá»•ng quan data sources |
| Data Warehouse | `/data-warehouse` | BigQuery management |
| Reconciliation | `/reconciliation` | Äá»‘i soÃ¡t e-commerce |

### 8.2 Connector Types

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CONNECTOR INTEGRATIONS                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  E-COMMERCE                SHIPPING                 BANKING      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Shopee   â”‚             â”‚ GHN      â”‚            â”‚ VCB      â”‚  â”‚
â”‚  â”‚ Lazada   â”‚             â”‚ GHTK     â”‚            â”‚ TCB      â”‚  â”‚
â”‚  â”‚ TikTok   â”‚             â”‚ Viettel  â”‚            â”‚ MBB      â”‚  â”‚
â”‚  â”‚ Tiki     â”‚             â”‚ J&T      â”‚            â”‚ BIDV     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  DATA WAREHOUSE           POS/ERP                  OTHER         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ BigQuery â”‚             â”‚ KiotViet â”‚            â”‚ Google   â”‚  â”‚
â”‚  â”‚ Snowflakeâ”‚             â”‚ Sapo     â”‚            â”‚ Analyticsâ”‚  â”‚
â”‚  â”‚          â”‚             â”‚ MISA     â”‚            â”‚ Facebook â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.3 Báº£ng dá»¯ liá»‡u

| Báº£ng | Má»¥c Ä‘Ã­ch |
|------|----------|
| `connector_integrations` | Cáº¥u hÃ¬nh káº¿t ná»‘i |
| `bigquery_configs` | Cáº¥u hÃ¬nh BigQuery |
| `bigquery_data_models` | Data models tá»« BQ |
| `sync_logs` | Log Ä‘á»“ng bá»™ |

### 8.4 Sync Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    API Call    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    Transform    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   External   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚    Edge      â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚   Supabase   â”‚
â”‚    Source    â”‚                â”‚   Function   â”‚                  â”‚   Tables     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ Log
                                       â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚  sync_logs   â”‚
                                â”‚  table       â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 9. Luá»“ng dá»¯ liá»‡u End-to-End

### 9.1 Order Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ORDER LIFECYCLE                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  Order   â”‚â”€â”€â–ºâ”‚ Shipped  â”‚â”€â”€â–ºâ”‚Delivered â”‚â”€â”€â–ºâ”‚Settlementâ”‚â”€â”€â–ºâ”‚  Cash    â”‚           â”‚
â”‚  â”‚ Created  â”‚   â”‚          â”‚   â”‚          â”‚   â”‚ Received â”‚   â”‚ In Bank  â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚       â”‚              â”‚              â”‚              â”‚              â”‚                  â”‚
â”‚       â–¼              â–¼              â–¼              â–¼              â–¼                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚external_ â”‚   â”‚shipping_ â”‚   â”‚delivery_ â”‚   â”‚channel_  â”‚   â”‚bank_     â”‚           â”‚
â”‚  â”‚orders    â”‚   â”‚tracking  â”‚   â”‚confirmed â”‚   â”‚settlements   â”‚transactions          â”‚
â”‚  â”‚          â”‚   â”‚          â”‚   â”‚          â”‚   â”‚          â”‚   â”‚          â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                                      â”‚
â”‚  Metrics Updated:                                                                    â”‚
â”‚  - Revenue (gross)          - Shipping cost    - COGS realized  - Net revenue       â”‚
â”‚  - Order count              - Carrier fees     - Return rate    - Platform fees     â”‚
â”‚  - AOV                      - Delivery time    - Complete rate  - Cash position     â”‚
â”‚                                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.2 Marketing â†’ Cash Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         MARKETING TO CASH CONVERSION                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                      â”‚
â”‚  Day 0           Day 1-3         Day 3-7         Day 7-14        Day 14-30          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  Ad   â”‚â”€â”€â”€â”€â”€â”€â–ºâ”‚ Click â”‚â”€â”€â”€â”€â”€â”€â–ºâ”‚ Order â”‚â”€â”€â”€â”€â”€â”€â–ºâ”‚Deliverâ”‚â”€â”€â”€â”€â”€â”€â–ºâ”‚ Cash  â”‚          â”‚
â”‚  â”‚ Spend â”‚       â”‚       â”‚       â”‚       â”‚       â”‚       â”‚       â”‚       â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚     â”‚               â”‚               â”‚               â”‚               â”‚               â”‚
â”‚     â”‚               â”‚               â”‚               â”‚               â”‚               â”‚
â”‚  Cash OUT        No Cash         Cash Locked     Cash Locked     Cash IN            â”‚
â”‚  (Immediate)     Movement        (Inventory)     (Platform)      (Settlement)       â”‚
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    DAYS TO CASH = ~14-30 days                                â”‚   â”‚
â”‚  â”‚    Cash Locked in Marketing Cycle = Ad_Spend Ã— Days_to_Cash / 30            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 10. Database Schema Overview

### 10.1 Core Entity Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ENTITY RELATIONSHIPS                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     1:N     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                      â”‚
â”‚  â”‚   tenants    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚    users     â”‚                                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚
â”‚         â”‚                                                                            â”‚
â”‚         â”‚ 1:N                                                                        â”‚
â”‚         â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚                                                                       â”‚           â”‚
â”‚  â–¼                â–¼                â–¼                â–¼                   â–¼           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚external_ â”‚   â”‚ invoices â”‚   â”‚  bills   â”‚   â”‚ expenses â”‚   â”‚ bank_    â”‚          â”‚
â”‚  â”‚ orders   â”‚   â”‚          â”‚   â”‚          â”‚   â”‚          â”‚   â”‚ accounts â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜          â”‚
â”‚       â”‚              â”‚              â”‚                              â”‚                â”‚
â”‚       â”‚ 1:N          â”‚ 1:N          â”‚ 1:N                          â”‚ 1:N            â”‚
â”‚       â–¼              â–¼              â–¼                              â–¼                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚external_ â”‚   â”‚ invoice_ â”‚   â”‚  bill_   â”‚                  â”‚  bank_   â”‚          â”‚
â”‚  â”‚order_items   â”‚  items   â”‚   â”‚  items   â”‚                  â”‚transactions          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚                        MARKETING DOMAIN                               â”‚           â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚           â”‚
â”‚  â”‚  â”‚  promotion_  â”‚   â”‚  marketing_  â”‚   â”‚  channel_    â”‚              â”‚           â”‚
â”‚  â”‚  â”‚  campaigns   â”‚   â”‚  expenses    â”‚   â”‚  analytics   â”‚              â”‚           â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚                          ALERT DOMAIN                                 â”‚           â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚           â”‚
â”‚  â”‚  â”‚ intelligent_ â”‚â”€â”€â–ºâ”‚   alert_     â”‚â”€â”€â–ºâ”‚ notification_â”‚              â”‚           â”‚
â”‚  â”‚  â”‚ alert_rules  â”‚   â”‚  instances   â”‚   â”‚    logs      â”‚              â”‚           â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.2 Key Views

| View | Purpose |
|------|---------|
| `ar_aging` | AR phÃ¢n theo tuá»•i ná»£ |
| `ap_aging` | AP phÃ¢n theo tuá»•i ná»£ |
| `cash_position` | Vá»‹ tháº¿ tiá»n máº·t tá»•ng há»£p |
| `channel_pl_summary` | P&L theo kÃªnh |
| `trial_balance` | Báº£ng cÃ¢n Ä‘á»‘i thá»­ |

---

## ğŸ“ Phá»¥ lá»¥c

### A. Edge Functions

| Function | Trigger | Purpose |
|----------|---------|---------|
| `detect-alerts` | Scheduled/Manual | QuÃ©t vÃ  táº¡o alerts |
| `sync-connector` | Scheduled | Sync data tá»« connectors |
| `sync-bigquery` | Scheduled | Sync data tá»« BigQuery |
| `process-alert-notifications` | After alert created | Gá»­i notifications |
| `analyze-financial-data` | Manual | AI phÃ¢n tÃ­ch tÃ i chÃ­nh |
| `decision-advisor` | Manual | AI Ä‘á» xuáº¥t quyáº¿t Ä‘á»‹nh |
| `optimize-channel-budget` | Manual | AI tá»‘i Æ°u ngÃ¢n sÃ¡ch |

### B. React Hooks (Key)

| Hook | Domain | Purpose |
|------|--------|---------|
| `useCentralFinancialMetrics` | FDP | Single source of financial metrics |
| `useAlertInstances` | Control Tower | Manage alerts |
| `useMDPData` | MDP | Marketing metrics |
| `useWhatIfScenarios` | Scenario | What-if calculations |
| `useDecisionCards` | Decision | Decision card management |

---

*TÃ i liá»‡u nÃ y Ä‘Æ°á»£c cáº­p nháº­t liÃªn tá»¥c theo phÃ¡t triá»ƒn cá»§a há»‡ thá»‘ng.*
