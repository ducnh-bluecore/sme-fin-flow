
-- Fix SECURITY DEFINER views by setting security_invoker = on
-- This ensures views respect the querying user's RLS policies
-- Note: v_retail_concentration_risk is a materialized view (not applicable)

ALTER VIEW public.ap_aging SET (security_invoker = on);
ALTER VIEW public.ar_aging SET (security_invoker = on);
ALTER VIEW public.cash_position SET (security_invoker = on);
ALTER VIEW public.credit_notes_view SET (security_invoker = on);
ALTER VIEW public.debit_notes_view SET (security_invoker = on);
ALTER VIEW public.decisions_pending_followup SET (security_invoker = on);
ALTER VIEW public.fdp_sku_summary SET (security_invoker = on);
ALTER VIEW public.v_active_alerts_hierarchy SET (security_invoker = on);
ALTER VIEW public.v_active_risk_appetite SET (security_invoker = on);
ALTER VIEW public.v_ai_advisor_active SET (security_invoker = on);
ALTER VIEW public.v_alerts_pending_escalation SET (security_invoker = on);
ALTER VIEW public.v_alerts_with_resolution SET (security_invoker = on);
ALTER VIEW public.v_all_revenue_summary SET (security_invoker = on);
ALTER VIEW public.v_ar_aging_buckets SET (security_invoker = on);
ALTER VIEW public.v_audience_customer_summary SET (security_invoker = on);
ALTER VIEW public.v_audience_rfm_summary SET (security_invoker = on);
ALTER VIEW public.v_bank_txn_match_state SET (security_invoker = on);
ALTER VIEW public.v_base_order_metrics SET (security_invoker = on);
ALTER VIEW public.v_board_report_invoices SET (security_invoker = on);
ALTER VIEW public.v_budget_reallocation_suggestions SET (security_invoker = on);
ALTER VIEW public.v_cash_flow_monthly SET (security_invoker = on);
ALTER VIEW public.v_cash_forecast_orders_weekly SET (security_invoker = on);
ALTER VIEW public.v_cash_lock_summary SET (security_invoker = on);
ALTER VIEW public.v_category_pl_summary SET (security_invoker = on);
ALTER VIEW public.v_ccc_with_targets SET (security_invoker = on);
ALTER VIEW public.v_cdp_category_conversion_stats SET (security_invoker = on);
ALTER VIEW public.v_cdp_customer_audit SET (security_invoker = on);
ALTER VIEW public.v_cdp_customer_category_affinity SET (security_invoker = on);
ALTER VIEW public.v_cdp_customer_research SET (security_invoker = on);
ALTER VIEW public.v_cdp_data_quality SET (security_invoker = on);
ALTER VIEW public.v_cdp_decision_cards_detail SET (security_invoker = on);
ALTER VIEW public.v_cdp_decision_evidence SET (security_invoker = on);
ALTER VIEW public.v_cdp_decision_queue SET (security_invoker = on);
ALTER VIEW public.v_cdp_demand_category_counts SET (security_invoker = on);
ALTER VIEW public.v_cdp_demand_insights SET (security_invoker = on);
ALTER VIEW public.v_cdp_demand_insights_triggered SET (security_invoker = on);
ALTER VIEW public.v_cdp_demographics_summary SET (security_invoker = on);
ALTER VIEW public.v_cdp_equity_distribution SET (security_invoker = on);
ALTER VIEW public.v_cdp_equity_drivers SET (security_invoker = on);
ALTER VIEW public.v_cdp_equity_evidence SET (security_invoker = on);
ALTER VIEW public.v_cdp_equity_overview SET (security_invoker = on);
ALTER VIEW public.v_cdp_equity_snapshot SET (security_invoker = on);
ALTER VIEW public.v_cdp_evidence_sample_customers_by_category SET (security_invoker = on);
ALTER VIEW public.v_cdp_highlight_signals SET (security_invoker = on);
ALTER VIEW public.v_cdp_insight_clusters_summary SET (security_invoker = on);
ALTER VIEW public.v_cdp_insight_detail SET (security_invoker = on);
ALTER VIEW public.v_cdp_insight_feed SET (security_invoker = on);
ALTER VIEW public.v_cdp_insight_quality_summary SET (security_invoker = on);
ALTER VIEW public.v_cdp_insight_registry_stats SET (security_invoker = on);
ALTER VIEW public.v_cdp_insight_registry_summary SET (security_invoker = on);
ALTER VIEW public.v_cdp_insight_topic_counts SET (security_invoker = on);
ALTER VIEW public.v_cdp_insights_with_actions SET (security_invoker = on);
ALTER VIEW public.v_cdp_ltv_audit_history SET (security_invoker = on);
ALTER VIEW public.v_cdp_ltv_by_cohort SET (security_invoker = on);
ALTER VIEW public.v_cdp_ltv_by_source SET (security_invoker = on);
ALTER VIEW public.v_cdp_ltv_decay_alerts SET (security_invoker = on);
ALTER VIEW public.v_cdp_ltv_rules SET (security_invoker = on);
ALTER VIEW public.v_cdp_ltv_summary SET (security_invoker = on);
ALTER VIEW public.v_cdp_orders_stats SET (security_invoker = on);
ALTER VIEW public.v_cdp_pending_decisions SET (security_invoker = on);
ALTER VIEW public.v_cdp_population_catalog SET (security_invoker = on);
ALTER VIEW public.v_cdp_population_changelog SET (security_invoker = on);
ALTER VIEW public.v_cdp_population_comparison SET (security_invoker = on);
ALTER VIEW public.v_cdp_population_detail SET (security_invoker = on);
ALTER VIEW public.v_cdp_population_summary SET (security_invoker = on);
ALTER VIEW public.v_cdp_product_benchmark SET (security_invoker = on);
ALTER VIEW public.v_cdp_research_stats SET (security_invoker = on);
ALTER VIEW public.v_cdp_rfm_segment_summary SET (security_invoker = on);
ALTER VIEW public.v_cdp_rfm_segments SET (security_invoker = on);
ALTER VIEW public.v_cdp_saved_research_views SET (security_invoker = on);
ALTER VIEW public.v_cdp_segment_summaries SET (security_invoker = on);
ALTER VIEW public.v_cdp_summary_stats SET (security_invoker = on);
ALTER VIEW public.v_cdp_topic_summaries SET (security_invoker = on);
ALTER VIEW public.v_cdp_trend_insights SET (security_invoker = on);
ALTER VIEW public.v_cdp_truth_snapshot SET (security_invoker = on);
ALTER VIEW public.v_cdp_value_distribution SET (security_invoker = on);
ALTER VIEW public.v_channel_analytics_total SET (security_invoker = on);
ALTER VIEW public.v_channel_daily_revenue SET (security_invoker = on);
ALTER VIEW public.v_channel_performance SET (security_invoker = on);
ALTER VIEW public.v_channel_pl_summary SET (security_invoker = on);
ALTER VIEW public.v_compute_job_health SET (security_invoker = on);
ALTER VIEW public.v_ct_truth_snapshot SET (security_invoker = on);
ALTER VIEW public.v_customer_ar_summary SET (security_invoker = on);
ALTER VIEW public.v_customer_order_items_detail SET (security_invoker = on);
ALTER VIEW public.v_decision_audit_trail SET (security_invoker = on);
ALTER VIEW public.v_decision_effectiveness SET (security_invoker = on);
ALTER VIEW public.v_decision_latest SET (security_invoker = on);
ALTER VIEW public.v_decision_outcome_stats SET (security_invoker = on);
ALTER VIEW public.v_decision_pending_followup SET (security_invoker = on);
ALTER VIEW public.v_executive_health_scores SET (security_invoker = on);
ALTER VIEW public.v_expense_plan_summary SET (security_invoker = on);
ALTER VIEW public.v_expense_variance_alerts SET (security_invoker = on);
ALTER VIEW public.v_expenses_by_category_monthly SET (security_invoker = on);
ALTER VIEW public.v_expenses_weekly_by_category SET (security_invoker = on);
ALTER VIEW public.v_fdp_finance_summary SET (security_invoker = on);
ALTER VIEW public.v_fdp_truth_snapshot SET (security_invoker = on);
ALTER VIEW public.v_financial_insights SET (security_invoker = on);
ALTER VIEW public.v_financial_monthly_summary SET (security_invoker = on);
ALTER VIEW public.v_financial_ratios_with_targets SET (security_invoker = on);
ALTER VIEW public.v_financial_report_kpis SET (security_invoker = on);
ALTER VIEW public.v_forecast_order_stats SET (security_invoker = on);
ALTER VIEW public.v_governance_dashboard SET (security_invoker = on);
ALTER VIEW public.v_inv_avg_unit_price SET (security_invoker = on);
ALTER VIEW public.v_inv_store_metrics SET (security_invoker = on);
ALTER VIEW public.v_inv_store_position_metrics SET (security_invoker = on);
ALTER VIEW public.v_inv_store_revenue SET (security_invoker = on);
ALTER VIEW public.v_invoice_key_metrics SET (security_invoker = on);
ALTER VIEW public.v_invoice_settled_paid SET (security_invoker = on);
ALTER VIEW public.v_invoice_settled_status SET (security_invoker = on);
ALTER VIEW public.v_latest_central_metrics SET (security_invoker = on);
ALTER VIEW public.v_locked_cash_detail SET (security_invoker = on);
ALTER VIEW public.v_lost_revenue_summary SET (security_invoker = on);
ALTER VIEW public.v_margin_leak_summary SET (security_invoker = on);
ALTER VIEW public.v_markdown_risk_summary SET (security_invoker = on);
ALTER VIEW public.v_mdp_campaign_attribution SET (security_invoker = on);
ALTER VIEW public.v_mdp_campaign_performance SET (security_invoker = on);
ALTER VIEW public.v_mdp_ceo_snapshot SET (security_invoker = on);
ALTER VIEW public.v_mdp_decision_signals SET (security_invoker = on);
ALTER VIEW public.v_mdp_funnel_summary SET (security_invoker = on);
ALTER VIEW public.v_mdp_marketing_funnel SET (security_invoker = on);
ALTER VIEW public.v_mdp_mode_summary SET (security_invoker = on);
ALTER VIEW public.v_mdp_order_items_summary SET (security_invoker = on);
ALTER VIEW public.v_mdp_platform_ads_summary SET (security_invoker = on);
ALTER VIEW public.v_mdp_scale_opportunities SET (security_invoker = on);
ALTER VIEW public.v_mdp_truth_snapshot SET (security_invoker = on);
ALTER VIEW public.v_metric_changelog SET (security_invoker = on);
ALTER VIEW public.v_pending_ap SET (security_invoker = on);
ALTER VIEW public.v_pending_approvals SET (security_invoker = on);
ALTER VIEW public.v_pending_ar SET (security_invoker = on);
ALTER VIEW public.v_pl_monthly_summary SET (security_invoker = on);
ALTER VIEW public.v_revenue_channel_daily SET (security_invoker = on);
ALTER VIEW public.v_risk_radar_summary SET (security_invoker = on);
ALTER VIEW public.v_rolling_forecast_summary SET (security_invoker = on);
ALTER VIEW public.v_size_health_by_state SET (security_invoker = on);
ALTER VIEW public.v_size_intelligence_summary SET (security_invoker = on);
ALTER VIEW public.v_top_products_30d SET (security_invoker = on);
ALTER VIEW public.v_transfer_by_destination SET (security_invoker = on);
ALTER VIEW public.v_upcoming_payment_alerts SET (security_invoker = on);
ALTER VIEW public.v_variance_orders_monthly SET (security_invoker = on);
ALTER VIEW public.v_variance_with_status SET (security_invoker = on);
ALTER VIEW public.vendor_credit_notes_view SET (security_invoker = on);
